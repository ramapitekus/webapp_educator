{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\olesr\\\\OneDrive\\\\Documents\\\\webapp_educ\\\\educator\\\\src\\\\Recording.js\",\n    _s = $RefreshSig$();\n\nimport { useCallback, useRef, useState } from \"react\";\nimport S2t from \"./S2t\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Recording = () => {\n  _s();\n\n  const mediaRecorder = useRef(null);\n  const mediaChunks = useRef([]);\n  const stream = useRef(null);\n  const [mediaBlobUrl, setMediaBlobUrl] = useState(null);\n  const blob = useRef(null);\n  const [audioArray, setAudioArray] = useState(null);\n  const [fd, setFd] = useState(null);\n  const getMediaStream = useCallback(async () => {\n    const audioStream = await window.navigator.mediaDevices.getUserMedia({\n      audio: true\n    });\n    audioStream.getAudioTracks().forEach(audioTrack => audioStream.addTrack(audioTrack)); //console.log(audioStream.getAudioTracks());\n\n    stream.current = audioStream;\n  }, []);\n\n  const onRecordingStop = async () => {\n    const blobProperty = Object.assign({\n      type: mediaChunks.current.type\n    }, {\n      type: \"audio/wav\"\n    });\n    blob.current = new Blob(mediaChunks.current, blobProperty);\n    const url = URL.createObjectURL(blob.current);\n    setMediaBlobUrl(url);\n    const reader = new FileReader();\n\n    reader.onload = function (e) {\n      setAudioArray(e.target.result);\n    };\n\n    reader.readAsArrayBuffer(blob.current);\n    var fd = new FormData();\n    fd.append(\"audio_data\", blob, \"output.wav\");\n    setFd(fd);\n  };\n\n  const pushChunk = _ref => {\n    let {\n      data\n    } = _ref;\n    mediaChunks.current.push(data);\n  };\n\n  const startRecording = async () => {\n    if (!stream.current) {\n      await getMediaStream();\n    }\n\n    if (stream.current) {\n      const isStreamEnded = stream.current.getTracks().some(track => track.readyState === \"ended\");\n\n      if (isStreamEnded) {\n        await getMediaStream();\n      }\n\n      mediaRecorder.current = new MediaRecorder(stream.current);\n      mediaRecorder.current.ondataavailable = pushChunk;\n      mediaRecorder.current.onstop = onRecordingStop;\n      mediaRecorder.current.start();\n    }\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorder.current) {\n      if (mediaRecorder.current.state !== \"inactive\") {\n        mediaRecorder.current.stop();\n        stream.current && stream.current.getTracks().forEach(track => track.stop());\n        mediaChunks.current = [];\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: startRecording,\n      children: \"Start Recording\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: stopRecording,\n      children: \"Stop Recording\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), fd && /*#__PURE__*/_jsxDEV(S2t, {\n      audio: fd\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 14\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      src: mediaBlobUrl,\n      controls: true,\n      autoPlay: true,\n      loop: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Recording, \"ewIQxPkQKJ6i6oAGxENwjwToHBo=\");\n\n_c = Recording;\nexport default Recording;\n\nvar _c;\n\n$RefreshReg$(_c, \"Recording\");","map":{"version":3,"sources":["C:/Users/olesr/OneDrive/Documents/webapp_educ/educator/src/Recording.js"],"names":["useCallback","useRef","useState","S2t","Recording","mediaRecorder","mediaChunks","stream","mediaBlobUrl","setMediaBlobUrl","blob","audioArray","setAudioArray","fd","setFd","getMediaStream","audioStream","window","navigator","mediaDevices","getUserMedia","audio","getAudioTracks","forEach","audioTrack","addTrack","current","onRecordingStop","blobProperty","Object","assign","type","Blob","url","URL","createObjectURL","reader","FileReader","onload","e","target","result","readAsArrayBuffer","FormData","append","pushChunk","data","push","startRecording","isStreamEnded","getTracks","some","track","readyState","MediaRecorder","ondataavailable","onstop","start","stopRecording","state","stop"],"mappings":"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","sourcesContent":["import { useCallback, useRef, useState } from \"react\";\r\nimport S2t from \"./S2t\";\r\n\r\nconst Recording = () => {\r\n  const mediaRecorder = useRef(null);\r\n  const mediaChunks = useRef([]);\r\n  const stream = useRef(null);\r\n  const [mediaBlobUrl, setMediaBlobUrl] = useState(null);\r\n  const blob = useRef(null);\r\n  const [audioArray, setAudioArray] = useState(null);\r\n  const [fd, setFd] = useState(null);\r\n\r\n  const getMediaStream = useCallback(async () => {\r\n    const audioStream = await window.navigator.mediaDevices.getUserMedia({\r\n      audio: true,\r\n    });\r\n    audioStream\r\n      .getAudioTracks()\r\n      .forEach((audioTrack) => audioStream.addTrack(audioTrack));\r\n    //console.log(audioStream.getAudioTracks());\r\n    stream.current = audioStream;\r\n  }, []);\r\n\r\n  const onRecordingStop = async () => {\r\n    const blobProperty = Object.assign(\r\n      { type: mediaChunks.current.type },\r\n      { type: \"audio/wav\" }\r\n    );\r\n    blob.current = new Blob(mediaChunks.current, blobProperty);\r\n    const url = URL.createObjectURL(blob.current);\r\n    setMediaBlobUrl(url);\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = function (e) {\r\n      setAudioArray(e.target.result);\r\n    };\r\n    reader.readAsArrayBuffer(blob.current);\r\n\r\n    var fd = new FormData();\r\n    fd.append(\"audio_data\", blob, \"output.wav\");\r\n    setFd(fd);\r\n  };\r\n\r\n  const pushChunk = ({ data }) => {\r\n    mediaChunks.current.push(data);\r\n  };\r\n\r\n  const startRecording = async () => {\r\n    if (!stream.current) {\r\n      await getMediaStream();\r\n    }\r\n    if (stream.current) {\r\n      const isStreamEnded = stream.current\r\n        .getTracks()\r\n        .some((track) => track.readyState === \"ended\");\r\n      if (isStreamEnded) {\r\n        await getMediaStream();\r\n      }\r\n\r\n      mediaRecorder.current = new MediaRecorder(stream.current);\r\n      mediaRecorder.current.ondataavailable = pushChunk;\r\n      mediaRecorder.current.onstop = onRecordingStop;\r\n      mediaRecorder.current.start();\r\n    }\r\n  };\r\n\r\n  const stopRecording = () => {\r\n    if (mediaRecorder.current) {\r\n      if (mediaRecorder.current.state !== \"inactive\") {\r\n        mediaRecorder.current.stop();\r\n        stream.current &&\r\n          stream.current.getTracks().forEach((track) => track.stop());\r\n        mediaChunks.current = [];\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button onClick={startRecording}>Start Recording</button>\r\n      <button onClick={stopRecording}>Stop Recording</button>\r\n      {fd && <S2t audio={fd} />}\r\n      <video src={mediaBlobUrl} controls autoPlay loop />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Recording;\r\n"]},"metadata":{},"sourceType":"module"}